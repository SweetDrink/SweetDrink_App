<main>
  <div class=" profile uk-child-width-1-2@m" uk-grid>
    <div class="per">
        <div class="uk-card uk-card-default">
            <div class="uk-card-media-top">
                <img src="http://warp.la/wp-content/uploads/2016/03/Fiesta.jpg" alt="">
            </div>
            <div class="uk-card-body">
                <h3 class="uk-card-title"> <i class="fas fa-user"></i> {{user.name}}</h3>
                <p><i class="fas fa-power-off"></i> Status: {{user.status}}</p>
                <p> <i class="fas fa-envelope"></i> Correo: {{user.email}}</p>
                <p> <i class="fas fa-mobile"></i> Teléfono cel: {{user.phone}}</p>
                <form action="/auth/logout" method="post"><button type="submit">Cerrar sesión</button></form>
            </div>
            <form class="e-form" action="/profile/edit" method="GET">
             <button type="submit" class=" edit uk-button uk-button-primary">Editar perfil <i class="fas fa-cog fa-spin"></i></button>
            </form>
        </div>
    </div>
    </div>
    <div id="map"></div>
</main>
 <script>
     window.onload = function () {
    const map = new google.maps.Map(document.getElementById("map"), {
      zoom: 17,
      center: {
        lat: 41.3977381,
        lng: 2.190471916
      }
    })
    const marker = new google.maps.Marker({
      position: {
        lat: 41.3977381,
        lng: 2.190471916
      },
      animation: google.maps.Animation.BOUNCE,
      icon: {
        url: "/images/tarro.png",
        scaledSize: new google.maps.Size(50, 50)
      },
      map,
      title: "I´m here"
    })

    // Try to get a geolocation object from the web browser
    if (navigator.geolocation) {

      // Get current position
      // The permissions dialog will popup
      navigator.geolocation.getCurrentPosition(function (position) {

        const user_location = {
          lat: position.coords.latitude,
          lng: position.coords.longitude
        };

        // Center map with user location
        map.setCenter(user_location);
        marker.setPosition(user_location);

        /*const directionsService = new google.maps.DirectionsService;
        const directionsDisplay = new google.maps.DirectionsRenderer;

        const directionRequest = {
          origin: user_location,
          destination:{
          lat: 19.4270245,
          lng: -99.16766469999999
        },
          travelMode: "DRIVING"
      };

      directionsService.route(
        directionRequest,
        function (response, status) {
          if (status === 'OK') {
            // everything is ok
            directionsDisplay.setDirections(response);

          } 
        });

      directionsDisplay.setMap(map);*/

      // Create an object to match
      // google's Lat-Lng object format
      const center = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      console.log('center: ', user_location)
      // User granted permission
      // Center the map in the position we got
    }, function () {
      // If something else goes wrong
      console.log('Error in the geolocation service.');
    });
  } else {
    // Browser says: Nah! I do not support this.
    console.log('Browser does not support geolocation.');
  }
}
</script>